
# 1. ê°œë…

 í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì—ê²Œ íŠ¹ì •í•œ ìš”ì²­ì´ë‚˜ ë¦¬ì†ŒìŠ¤ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ë°”ë””ë¡œ ë³´ë‚´ëŠ” ë°ì´í„°ê°€ ìœ íš¨í•œì§€ , ì •í™•í•œ ë°ì´í„°ë¥¼ ë³´ë‚´ê³  ìˆëŠ” ì§€ í™•ì¸í•˜ëŠ” ê³¼ì •ì´ë‹¤. ë³´í†µ ìŠ¤í‚¤ë§ˆê°€ í™•ì •ëœ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì´ìš©í•˜ë©´ ì–´ë–¤ íŠ¹ì •í•œ í•„ë“œì— ì •í™•í•œ íƒ€ì…ì¸ì§€ ì •ì˜ê°€ ë˜ì–´ ìˆì–´ í•´ë‹¹ ìš”ì²­ì— í•„ìš”í•œ ëª¨ë“  ë°ì´í„°ê°€ ì •ìƒì ìœ¼ë¡œ ì™”ëŠ”ì§€ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ ìª½ì—ì„œ í•  ìˆ˜ ìˆë‹¤.

 í•˜ì§€ë§Œ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•  ë•Œê¹Œì§€ ì•„ë¬´ëŸ° ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•˜ì§€ì•ŠëŠ”ê±´ ìµœì•…ì´ë‹¤. ê·¸ë˜ì„œ ì„œë²„ì—ì„œë„ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•  ìˆ˜ ìˆë‹¤. ì„œë²„ì—ì„œë„ ë™ì‘í•˜ëŠ” ê¸°ëŠ¥ë“¤ì€ ë‹¤ ê¸ˆì „ì  ë¬¸ì œë¡œ ì´ì–´ì§€ê¸° ë•Œë¬¸ì— ì´ ê²€ì‚¬ë¥¼ ë¹¨ë¦¬í•  ìˆ˜ë¡ ì¢‹ë‹¤.ì„œë²„ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì½ ì“°ëŠ” ê²ƒë„ ë‹¤ ë¹„ìš©ì´ê³  ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì½ê³  ì“°ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ì‚¬ìš©ì ìš”ì²­ì„ ì²˜ë¦¬í•  ìˆ˜ ì—†ì„ ìˆ˜ë„ ìˆë‹¤. ê·¸ë ‡ê¸°ì— ë¹¨ë¦¬ ìœ íš¨ì„±ê²€ì‚¬ë¥¼ í•˜ëŠ”ê²Œ ì¢‹ë‹¤. ìš°ë¦¬ê°€ í•¨ìˆ˜ë¥¼ ë§Œë“¤ë•Œë„ í•¨ìˆ˜ë¥¼ ë§Œë“¤ ë•Œ í•„ìš”í•œ ëª¨ë“  ì¸ìê°€ ì ì ˆí•œì§€ ì²˜ìŒì— í™•ì¸í•´ì„œ ë¦¬í„´í•˜ëŠ” ê²ƒ ì²˜ëŸ¼ ì„œë²„ì—ì„œë„ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ë¹¨ë¦¬í•˜ëŠ”ê²Œ ì¢‹ë‹¤. 

ê·¸ë¦¬ê³  ì„œë²„ì—ì„œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•˜ë”ë¼ë„ í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•´ì„œ ìš”ì²­í•œê²ƒì— ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•œ ë’¤ ì„œë²„ì—ì„œ ë°˜ì‘ì„ í•´ì•¼í•˜ë¯€ë¡œ ë„¤íŠ¸ì›Œí¬ë¥¼ ì†Œëª¨í•œë‹¤.. ì´ë•Œ ë°œìƒí•˜ëŠ” ë¹„ìš©ì„ ì ˆì•½í•˜ê¸° ìœ„í•´ì„œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œë„ í´ë¼ì´ì–¸íŠ¸ë§Œì˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•  ìˆ˜ ìˆë‹¤. (optional) 

# 2. ìœ íš¨ì„± ê²€ì‚¬

ê·¸ë ‡ìë©´ ì–´ë–¤ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•´ì•¼í• ê¹Œ? ìƒˆë¡œìš´ ì‚¬ìš©ìë¥¼ ë§Œë“¤ ë•Œ ì‚¬ìš©ì ì´ë¦„, ë‚˜ì´, ì´ë©”ì¼ ì–‘ì‹ ë“±ë“± ì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•´ì•¼í•œë‹¤. ì´ë¥¼ ë§Œì•½ ìˆ˜ë™ìœ¼ë¡œ í•˜ê²Œ ëœë‹¤ë©´ ì½”ë“œê°€ ì§€ì €ë¶„ í•´ì§ˆ ìˆ˜ ìˆëŠ”ë° ì´ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìœ ìš©í•œ ë¯¸ë“¤ì›¨ì–´ê°€ ìˆë‹¤. 

```java
npm i express-validator
```

ì´ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ ì‹¤ì œë¡œ ë¡œì§ì´ ë°œìƒí•˜ëŠ” callbackì´ì „ì— ì—¬ëŸ¬ê°€ì§€ callbackì„ ë“±ë¡í•  ìˆ˜ ìˆë‹¤. handlerëŠ” ë°°ì—´ í˜ˆíƒœë¡œ ì—¬ëŸ¬ê°€ì§€ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆë‹¤. ë˜í•œ withMessageë¥¼ í†µí•´ ì—ëŸ¬ ë©”ì„¸ì§€ë„ ì „ë‹¬í•  ìˆ˜ìˆë‹¤. 

body í•„ë“œì— ê¸¸ì´ë¥¼ 2~10ê¸€ìë¡œ ì§€ì •ì„ í•˜ê³  2ê¸€ìë³´ë‹¤ ì ê²Œ ì „ë‹¬ì„ í•œë‹¤ë©´ ë“±ë¡í•œ ë©”ì„¸ì§€ì™€ í•¨ê»˜ ì‘ë‹µ ë°›ëŠ”ë‹¤.

```java
import express from 'express';
import {body,param, validationResult} from 'express-validator';

const app = express();
app.use(express.json()) ;

//body('íŠ¹ì •í•œ í•„ë“œ ì´ë¦„').isLength({min:2, max:10})  ìµœì†Œê¸¸ì´ê°€ 2 ìµœëŒ€ 10

app.post('/users', body('name').isLength({min:2, max:10}).withMessage('ì´ë¦„ì€ ë‘ê¸€ì ì´ìƒ'),(req, res, next) => {
		//ì—ëŸ¬ = ë¦¬ì¿¼ìŠ¤íŠ¸ë¥¼ ì „ë‹¬í•´ì„œ í•´ë‹¹ reqê°€ ë“±ë¡í•œ ìœ íš¨ì„± ê²€ì‚¬ì— ì—ëŸ¬ê°€ ìˆëŠ”ì§€ ì—†ëŠ”ì§€ í™•ì¸í•˜ê³ 
    const errors = validationResult(req); 
		// errorsê°€ ë¹„ì–´ì‡ì§€ ì•Šë‹¤ë©´ ì—ëŸ¬ê°€ ë°œìƒí•œê²ƒìœ¼ë¡œ 400ì—ëŸ¬
    if(!errors.isEmpty()) { 
        // res.status(400).json({message : errors.err})ë„ ë˜ê³ 
    return    res.status(400).json({message : errors.array()}) ë°°ì—´ë¡œë„ ë³´ë‚¼ ìˆ˜

    }

    console.log(req.body);
   return res.sendStatus(201);
});

app.listen(8080);
```

- ê²°ê³¼

```java
{
    "message": [
        {
            "value": "e",
            "msg": "ì´ë¦„ì€ ë‘ê¸€ì ì´ìƒ",
            "param": "name",
            "location": "body"
        }
    ]
}
```

ë˜í•œ chainingì´ ë¨ìœ¼ë¡œ ì´ë¦„ì´ ë¹„ì–´ìˆë‹¤ë©´ "ì´ë¦„ ì…ë ¥í•´" ë¼ëŠ” ë©”ë©”ì‹œì§€ì™€ í•¨ê»˜ ë‘ê°€ì§€ ë©”ì„¸ì§€ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤. 

```java
app.post('/users', body('name')**.notEmpty().withMessage('ì´ë¦„ ì…ë ¥í•´').**isLength({min:2}).withMessage('ì´ë¦„ì€ ë‘ê¸€ì ì´ìƒ'),(req, res, next) => {
    const errors = validationResult(req); 
    if(!errors.isEmpty()) { 
    return    res.status(400).json({message : errors.array()}); 

    }
```

- ê²°ê³¼

```java
"message": [
        {
            "msg": "ì´ë¦„ ì…ë ¥í•´",
            "param": "name",
            "location": "body"
        },
        {
            "msg": "ì´ë¦„ì€ ë‘ê¸€ì ì´ìƒ",
            "param": "name",
            "location": "body"
        }
    ]
```

ì´ì²˜ëŸ¼ ì—¬ëŸ¬ê°€ì§€ í•„ë“œì— ëŒ€í•´ì„œë„ í•  ìˆ˜ ìˆê³ , ì´ í•­ëª©ë“¤ì„ ë°°ì—´ë¡œ ë¬¶ì–´ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. 

```java
app.post('/users', 
**[
    body('name').notEmpty().withMessage('ì´ë¦„ ì…ë ¥í•´').isLength({min:2}).withMessage('ì´ë¦„ì€ ë‘ê¸€ì ì´ìƒ'),
    body('age').notEmpty().isInt().withMessage('ìˆ«ì ì…ë ¥í•´'),
    body('email').isEmail().withMessage('email ì…ë ¥í•´'),
    body('job.name').notEmpty(),
    
]**
    ,(req, res, next) => {
    const errors = validationResult(req); 
    if(!errors.isEmpty()) { 
     return   res.status(400).json({message : errors.array()}); 

    }
```

ë˜í•œ get ìš”ì²­ ì‹œ paramì— ëŒ€í•´ì„œë„ ê²€ì‚¬í•  ìˆ˜ ìˆë‹¤. ì´ë•Œ ì—¬ëŸ¬ê°€ì§€ checkFunctionì„ ë¯¸ë“¤ì›¨ì–´ì—ì„œ ì§€ì›í•˜ëŠ”ë°, checkë¡œ ì§„í–‰í•  ê²½ìš° ëª¨ë“  í•­ëª©ì— ëŒ€í•´ì„œ ê²€ì‚¬í•  ìˆ˜ ìˆë‹¤. 

```java
app.get('/:email', param('email').isEmail().withMessage('email ì…ë ¥í•´'),
    (req, res, next) => {
        
    const errors = validationResult(req); 
    if(!errors.isEmpty()) { 
       return  res.status(400).json({message : errors.array()}); 

    }

    res.send('ğŸ')
});
```

# 3. sanaitization ê²€ì‚¬

ì‚¬ìš©ì ì´ë¦„ì€ ë‘ ê¸€ìì¸ë° ìŠ¤í˜ì´ìŠ¤ë¥¼ ì„¸ë²ˆí•´ì„œ "   " í•´ì„œ postë¥¼ í•  ê²½ìš° ì„¸ê¸€ìì„ìœ¼ë¡œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í†µê³¼í•˜ê²Œ ëœë‹¤. ê·¸ë ‡ê¸°ì— ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•  ë•Œ ì‚¬ìš©ìì—ê²Œ ë°›ì€ ë°ì´í„°ë¥¼ sanaitizationì„ í•´ì¤˜ì•¼í•œë‹¤. 

ì²˜ìŒìœ¼ë¡  ì–´ë–»ê²Œ ìœ íš¨ì„± ê²€ì‚¬ë¥´ë¥´ í•˜ê³  ì–´ë–»ê²Œ ë°ì´í„°ë¥¼ nomailize(í‘œì¤€í™”) í•  ê²ƒì¸ì§€ ìƒê°í•´ì•¼í•œë‹¤. ê³µë°±ì— ëŒ€í•´ì„œëŠ” trimì´ë¼ëŠ” ê²Œ ìˆë‹¤. ë¬¸ìì—´ë¡œ ì‹œì‘í•˜ëŠ” ê³µë°±ì´ ì‡ë‹¤ë©´ ê³µë°±ì„ ì œê³µí•´ì¤€ë‹¤. trim()ì„ ì•ì— ì¶”ê°€í•´ì£¼ë©´ ê³µë°±ì„ ì œê±°í•˜ì—¬ í‘œì¤€í™” ì‘ì—…ì„ í•œ ë’¤ ê°’ì„ ë³´ë‚¸ë‹¤. ê·¸ë ‡ê¸°ì— ìˆœì„œê°€ ì¤‘ìš”í•˜ë‹¤. ìœ íš¨ì„± ì‘ì—… ì´ì „ì— trim()ì„ í•˜ì—¬ ê³µë°±ì„ ì—†ì•¤ ë’¤ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.

```java
body('name')**.trim()**.notEmpty().withMessage('ì´ë¦„ ì…ë ¥í•´').isLength({min:2}).withMessage('ì´ë¦„ì€ ë‘ê¸€ì ì´ìƒ')
```

![Untitled](https://user-images.githubusercontent.com/63430211/121526158-19821e00-ca34-11eb-91a3-a04afe260900.png)

trim() ì´ì „

![Untitled 1](https://user-images.githubusercontent.com/63430211/121526166-1a1ab480-ca34-11eb-9f89-db0e4747801e.png)

trim()í›„ #1

![Untitled 2](https://user-images.githubusercontent.com/63430211/121526169-1ab34b00-ca34-11eb-8898-7131c904319f.png)


trim() í›„ #2

ì´ë©”ì¼ ì—­ì‹œë‚˜ ë§ˆì§€ë§‰ì— nomalizaEmailì„ í•´ì£¼ë©´ ëŒ€ë¬¸ìë¡œ ë“¤ì–´ì˜¤ëŠ” ê²ƒì„ ì†Œë¬¸ìë¡œ ë°”ê¾¸ì–´ ë³´ë‚´ì¤€ë‹¤. ìì„¸í•œê±´ sanitizers apië¥¼ ë³´ë©´ ìì„¸íˆ ì•Œ ìˆ˜ ìˆë‹¤. 

```java
body('email').isEmail().withMessage('email ì…ë ¥í•´').normalizeEmail,
```

ì—¬ê¸°ì„œ í¬ì¸íŠ¸ëŠ” ì„œë²„ì—ì„œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•´ì„œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì•Œë ¤ì£¼ëŠ” ê²ƒë„ ì¤‘ìš”í•˜ê³   db ì €ì¥ ì´ì „ì— ì¼ê´€ì„±ìˆê²Œ í•´ì£¼ëŠ” ê²ƒë„ ì¤‘ìš”í•˜ë‹¤.