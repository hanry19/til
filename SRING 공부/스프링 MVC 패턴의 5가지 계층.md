# 스프링 MVC 패턴의 5가지 계층

자바를 이용해 기업용 비즈니스 시스템을 구축하는 것은 쉬운일이 아니다. 

개발자들은 **복잡도를 낮추기 위해** MVC 패턴이 녹아 있는 **n-계층 C/S환경(Client Server)을 구성**하기시작했고, 시간이 흘러 대규모 웹 애플리케이션은 **다섯가지 계층으로 일반화** 되었다.

1. **프리젠테이션 계층 (presenttion layer)**
2. **제어계층 (control  layer)**
3. **비즈니스 로직 계층 (business logic layer)**
4. **퍼시스턴스(영속성) 계층 (persistence layer)**
5. **도메인 모델 계층 (domain model layer)**

1. **프리젠테이션 계층**
    - 역할

        사용자 인터페이스. 

        예시) 손님이 접하게 되는 **메뉴판**과 전달될 음식을 차려놓는 **식탁**

    - 기능

        **사용자가 선택할 수 있는 기능이 표시** 되어야 한다. 

        **요청에 필요한** 부가적인 **정보 전달을 위한 입력 양식**이 있어야 한다. 

        전달된 자료를 효과적으로 보여주기위한 프리젠테이션 로직이 포함된다.

        하지만 비즈니스 로직ㅇ나 퍼시스턴스 계층에서 처리하는 일을 직접 수행하거나 각 계층의 컴포넌트와 직접적인 통신이 있으면 안된다.

    - 대안기술

        JSP / JSTL과 같은 태그 라이브러리를 결합하는 방식

    - 주요패턴

        Composite View 패턴

2. **제어 계층**
    - 역할

        프리젠테이션 계층과 비즈니스 로직 계층을 분리하기 위한 컨트롤러를 제공

        예시) 식당 지배인의 역할과 종업원의 역할을 병행하는 것

    - 기능

        전체 시스템의 설정 상태를 유지하고, 어떤 요청이 들어왔을 때 어떤 로직이 처리해야 하는지 결정

        사용자 요청을 검증하고 로직에 요청을 전달하는 일과 로직에서 전달된 응답을 적절한 뷰에 연결짓는 것 역시 제어 계층의 몫

        예시) 손님이 바다가재 요리 요청 시 종업원은 그 요리가 서비스 가능한 것인지, 누구에게 시키면 되는지 알고 있어야 한다는 의미!!

        요청을 전달받은 요리사가 바다가재 요리를 주면 그것을 식탁까지 운반해 주는 것 역시 종업원의 몫!

        UI 검증, 요청 및 응답 전ㄷ달, 로직에서 던져진 예외처리, 도메인 모델을 뷰와 연결하기 등의 고유 기능 외에는 어떤 기능도 포함하지 않는다. 

    - 주요 패턴

        Front Controller, Service to Worker 패턴(Command 패턴) , Interception Fiter패턴, Application Controller , Context Object 패턴

3. **비즈니스 로직 계층**
    - 역할

        핵심 업무를 어떻게 처리하는지 서술한 곳

        종업원이 고객요구를 전달하면 재료를 이용해 요리를 만드는 요리사!

        비즈니스 로직 계층은 애플리케이션에서 가장 재사용될 확률이 높은 요소

    - 기능

        핵심 업무 로직의 구현과 관련된 데이터의 적함성 검증 외에도 다양한 부가적인 구현이 추가된다. 

        **트랜잭션 처리 같은 다른 계층과 통신하기 위한 인터페이스 제공** 및 **해당 계층의 객체들간의 관계를 관리**하는 것

        비즈니스 로직 계층에 있어야 할 코드들이 프리젠테이션 계층이나 퍼시스턴스 계층에 여기저기 흩어져 있는 애플리케이션을 찾아보기란 쉽다. 

        이런 구조는 각각의 계층을 모호하게 만들어 유지보수 시 많은 시간 필요

        가장 신경써서 개발해야 할 비즈니스 로직에 그동안 신경을 쓰지 못했다는 것. 프리젠테이션 계층과 퍼시스턴스 계층 사이의 다리 역할을 충실히 하도록 함으로 써 애플리케이션에 유연성을 더하는 것. 그것이 스프링이 탄생하게 된 배경!!

    - 주요 패턴

        Business Delegate ,Session Facade , Sevice Lcator, Application Service, EJB Home Factory 패턴

4. **퍼시스턴스(영속성) 계층**
    - 역할

        데이터 처리를 담당하는 계층

        데이터 CRUD 연산을 수행

        주방장이 사용할 재료를 담당하는 재료 담당자

        이는 주로 데이터베이스에서 처리되어 영속성을 의미하는 퍼시스턴스 계층이란 용어를 사용.

        하지만 데이터가 처리되는 다름 업무 시스템이나, 웹 서비스, XML, 파일 시스템 등을 모두 고려한다면 레거시 개념을 갖는 EIS 계층이 더 적합

    - 기능

        관계형 정보를 저장 수정, 삭제 하는 것

        그리고 일을 수행하는데 필요한 질의문을 관리하는 것. 

        그리고 가져온 관계형 정보를 객체화 시키는 것

    - 주요 패턴

        DAO(Data Access Object) , Domain Store , Sequence Blocks

5. **도메인 계층**
    - 역할

        각 계층 사이에 전달되는 실질적인 비즈니스 객체

        음식이 담긴 그릇

    - 기능

        데이터 전송객체(DTO) 형태로 개발자가 직접 제작하여 리퀘스트나 세션과 같은 컨텍스트에 담아 넘기게 된다. 하지만 데이터베이스의 모든 정보를 일일이 객체로 만드는 것은 귀찮을 뿐 아니라 계층간의 통신과정에서 데이터가 유실될 위험도 있기 때문에 최근에는 도메인 모델을 서비스로 제공하여 자동화 하는 경우가 많다. 

    - 주요 패턴

        DTO(Data Transfer Object), Value List Handler패턴